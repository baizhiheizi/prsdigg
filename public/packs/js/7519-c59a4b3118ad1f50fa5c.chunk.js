(self.webpackChunkprsdigg=self.webpackChunkprsdigg||[]).push([[7519],{49101:function(e,t,r){"use strict";r.d(t,{Z:function(){return i}});var n=r(67294),a={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},l=r(59418),c=function(e,t){return n.createElement(l.Z,Object.assign({},e,{ref:t,icon:a}))};c.displayName="PlusOutlined";var i=n.forwardRef(c)},43069:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});r(74407);var n=r(31097),a=(r(3829),r(60331)),l=(r(39200),r(55019)),c=r(49101),i=r(67294);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==r)return;var n,a,l=[],c=!0,i=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(o){i=!0,a=o}finally{try{c||null==r.return||r.return()}finally{if(i)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return u(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function s(e){var t=e.tags,r=e.setTags,u=o((0,i.useState)(!1),2),s=u[0],m=u[1],f=o((0,i.useState)(""),2),d=f[0],p=f[1],b=o((0,i.useState)(-1),2),y=b[0],h=b[1],v=o((0,i.useState)(""),2),g=v[0],E=v[1],Z=(0,i.useRef)(null),w=(0,i.useRef)(null);(0,i.useEffect)((function(){s&&Z.current.focus()}),[s]),(0,i.useEffect)((function(){-1!==y&&w.current.focus()}),[y]);var O=function(){d&&-1===t.indexOf(d)&&r([].concat(t,[d])),p(""),m(!1)},C=function(){var e=[].concat(t);e[y]=g,r(e),E(""),h(-1)};return i.createElement("div",null,t.map((function(e,c){if(y===c)return i.createElement(l.Z,{ref:w,style:{width:78,marginRight:8,verticalAlign:"top"},size:"small",key:e,value:g,onChange:function(e){return E(e.target.value)},onBlur:C,onPressEnter:C});var o=e.length>20,u=i.createElement(a.Z,{key:e,closable:!0,onClose:function(){return n=e,r(t.filter((function(e){return e!==n})));var n}},i.createElement("span",{onDoubleClick:function(t){0!==c&&(h(c),E(e),w.current.focus(),t.preventDefault())}},"#",o?e.slice(0,20)+"...":e));return o?i.createElement(n.Z,{title:e,key:e},u):u})),s&&i.createElement(l.Z,{ref:Z,style:{width:78,marginRight:8,verticalAlign:"top"},size:"small",type:"text",value:d,onChange:function(e){return p(e.target.value)},onBlur:O,onPressEnter:O}),!s&&i.createElement(a.Z,{style:{background:"#fff",borderStyle:"dashed"},onClick:function(){return m(!0)}},i.createElement(c.Z,null)," New Tag"))}},56831:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});r(58481);var n=r(48086),a=r(6799),l=r(67294);function c(e){var t=(0,a.kU)().attachmentEndpoint;return l.createElement("input",{className:"hidden",id:"upload-image-input",type:"file",accept:"image/*",multiple:!0,onChange:function(r){Array.from(r.target.files).forEach((function(r){n.ZP.loading("..."),(0,a.ws)(r,(function(r){r.url=t+"/"+r.key,e.callback(r),n.ZP.destroy()}))}))}})}},17519:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return k}});r(67167);var n=r(71577),a=(r(61768),r(8834)),l=(r(51872),r(19650)),c=(r(75257),r(51890)),i=(r(14564),r(48835)),o=(r(39200),r(55019)),u=(r(945),r(3785)),s=(r(13816),r(37744)),m=(r(58481),r(48086)),f=(r(38319),r(86585)),d=r(2826),p=r(67823),b=r(6799),y=r(39387),h=r(67294),v=r(8134),g=r(5977),E=r(73727),Z=r(43069),w=r(56831);function O(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?O(Object(r),!0).forEach((function(t){I(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=e&&("undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"]);if(null==r)return;var n,a,l=[],c=!0,i=!1;try{for(r=r.call(e);!(c=(n=r.next()).done)&&(l.push(n.value),!t||l.length!==t);c=!0);}catch(o){i=!0,a=o}finally{try{c||null==r.return||r.return()}finally{if(i)throw a}}return l}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return S(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function k(){var e=(0,g.UO)().uuid,t=N(f.Z.useForm(),1)[0],r=N((0,h.useState)(0),2),O=r[0],I=r[1],S=(0,g.k6)(),k=(0,v.$)().t,P=N((0,h.useState)([]),2),_=P[0],j=P[1],A=(0,y.YVq)({fetchPolicy:"network-only",variables:{uuid:e}}),x=A.data,R=A.loading,q=N((0,y.Mq1)({update:function(t,r){var n=r.data.updateArticle.error;n?m.ZP.error(n):(m.ZP.success(k("success_submitted")),S.replace("/articles/"+e))}}),2),T=q[0],U=q[1].loading;if((0,h.useEffect)((function(){var e;j((null==x||null==(e=x.myArticle)?void 0:e.tagNames)||[])}),[x]),R)return h.createElement(p.Z,null);var F=x.myArticle;return h.createElement("div",null,h.createElement(s.Z,{title:k("edit_article"),breadcrumb:{routes:[{path:"/articles",breadcrumbName:k("articles_manage")},{path:"/articles/"+e,breadcrumbName:F.title},{path:"",breadcrumbName:k("edit_article")}],itemRender:function(e,t,r,n){return r.indexOf(e)===r.length-1?h.createElement("span",null,e.breadcrumbName):h.createElement(E.rU,{to:e.path},e.breadcrumbName)}}}),h.createElement(w.Z,{callback:function(e){t.setFieldsValue({content:t.getFieldValue("content")+"\n!["+e.filename+"]("+e.url+")\n"})}}),h.createElement(f.Z,{form:t,initialValues:{uuid:e,title:F.title,intro:F.intro,content:F.content,price:F.price,assetId:F.assetId},labelCol:{span:2},wrapperCol:{span:22},onFinish:function(e){var t=e.uuid,r=e.title,n=e.content,a=e.price,l=e.intro;r&&n&&(a===F.price||a)&&l?u.Z.confirm({title:k("article.form.confirm_to_update"),centered:!0,okText:k("update"),cancelText:k("later"),onOk:function(){return T({variables:{input:{uuid:t,title:r,content:n,price:a,intro:l,tagNames:_}}})}}):m.ZP.warn(k("article.form.not_finished"))}},h.createElement(f.Z.Item,{style:{display:"none"},name:"uuid"},h.createElement(o.Z,null)),h.createElement(f.Z.Item,{label:k("article.title"),name:"title"},h.createElement(o.Z,{placeholder:k("article.form.title_place_holder")})),h.createElement(f.Z.Item,{label:k("article.content"),name:"content"},h.createElement(d.ZP,{textareaProps:{placeholder:k("article.form.content_place_holder")},previewOptions:C({},b.$1),autoFocus:!1,preview:"edit",height:500,commands:[d.CN.Se,d.CN.pU,d.CN.mW,d.CN.hr,d.CN.TN,d.CN.qE,d.CN.p4,d.CN.TU,b.H7,d.CN.qE,d.CN.GH,d.CN.Vf]})),h.createElement(f.Z.Item,{label:k("article.intro"),name:"intro"},h.createElement(o.Z.TextArea,{placeholder:k("article.form.intro_place_holder")})),h.createElement(f.Z.Item,{label:k("article.tags")},h.createElement(Z.Z,{tags:_,setTags:j})),h.createElement(f.Z.Item,{label:k("article.price"),extra:"\u2248 $"+(F.currency.priceUsd*(O||F.price)).toFixed(4)},h.createElement(l.Z,null,h.createElement(f.Z.Item,{name:"price",noStyle:!0,rules:[{required:!0},{validator:function(e,t){return"BTC"===F.currency.symbol&&t>=1e-6||F.price==t?Promise.resolve():Promise.reject(k("article.form.price_is_too_low"))}}]},h.createElement(i.Z,{disabled:0===F.price,onChange:function(e){return I(parseFloat(e.toString()))},style:{minWidth:130},min:1e-6,step:"0.000001",precision:6,placeholder:"0.0"})),h.createElement(f.Z.Item,{name:"assetId",noStyle:!0,rules:[{required:!0}]},h.createElement(a.Z,{disabled:!0},h.createElement(a.Z.Option,{key:F.currency.assetId,value:F.currency.assetId},h.createElement(l.Z,null,h.createElement(c.C,{size:"small",src:F.currency.iconUrl}),F.currency.symbol)))))),h.createElement(f.Z.Item,{label:k("article.form.revenue_distribution")},h.createElement(f.Z.Item,{label:k("readers_revenue")},h.createElement(i.Z,{disabled:!0,value:F.readersRevenueRatio,formatter:function(e){return 100*e+"%"}})),h.createElement(f.Z.Item,{label:k("platform_revenue")},h.createElement(i.Z,{disabled:!0,value:F.platformRevenueRatio,formatter:function(e){return 100*e+"%"}})),h.createElement(f.Z.Item,{label:k("author_revenue")},h.createElement(i.Z,{disabled:!0,value:F.authorRevenueRatio,formatter:function(e){return Math.floor(100*e)+"%"}})),F.articleReferences.length>0&&h.createElement(f.Z.Item,{label:k("article_references")},F.articleReferences.map((function(e){return h.createElement(f.Z.Item,{key:e.reference.uuid},h.createElement("div",{className:"flex flex-wrap items-center"},h.createElement(c.C,{className:"mr-2",size:"small",src:e.reference.author.avatar}),h.createElement("span",{className:"mr-2"},e.reference.author.name,":"),h.createElement("a",{href:"/articles/"+e.reference.uuid,target:"_blank"},e.reference.title),h.createElement("div",{className:"ml-auto text-blue-500"},100*e.revenueRatio,"%")))})))),h.createElement(f.Z.Item,{wrapperCol:{xs:{offset:0},sm:{offset:2}}},h.createElement(n.Z,{type:"primary",htmlType:"submit",loading:U},k("update")))))}}}]);
//# sourceMappingURL=7519-c59a4b3118ad1f50fa5c.chunk.js.map